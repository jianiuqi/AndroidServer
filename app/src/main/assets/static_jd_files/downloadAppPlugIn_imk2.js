(function(){var I=navigator.userAgent;var P=I.match(/Chrome/i)!=null&&I.match(/Version\/\d+\.\d+(\.\d+)?\sChrome\//i)==null?true:false;var Q=(I.match(/(Android);?[\s\/]+([\d.]+)?/))?true:false;var a=(I.match(/(iPad).*OS\s([\d_]+)/))?true:false;var K=(I.match(/(Mac\sOS)\sX\s([\d_]+)/))?true:false;var s=(!a&&I.match(/(iPhone\sOS)\s([\d_]+)/))?true:false;var c=(s||a)&&I.match(/Safari/);var w=I.match(/MQQBrowser\/([\d\.]+)/)?true:false;var p=I.match(/UCBrowser\/([\d\.]+)/)?true:false;var O=0;c&&(O=I.match(/Version\/([\d\.]+)/));try{O=parseFloat(O[1],10)}catch(R){}var l=navigator.userAgent.indexOf("MicroMessenger")>=0;var I=window.navigator.userAgent,M=false;var M=I.toUpperCase().indexOf("SAMSUNG-SM-N7508V")!=-1;var k=false;var u="plugIn_downloadAppPlugIn_loadIframe";var v=false;var j=0;var F={};var b={};var g=null;var N={};var x=window.Zepto||window.jQuery?true:false;var i=[];var y=window.localStorage?true:false;var q="mdownloadAppPlugInskip";var r=null;function n(){var S=new Date();var T=S.getFullYear();var U=S.getMonth()+1;var e=S.getDate();strDate=T+"-"+U+"-"+e;return strDate}function t(){WeixinJSBridge.invoke("getInstallState",{packageName:"com.jingdong.app.mall",packageUrl:"openApp.jdMobile://"},function(T){var U=T.err_msg,S=0;if(U.indexOf("get_install_state:yes")>-1){k=true}})}function d(T,S,e){if(x){g("#"+T).bind(S,e)}else{g("#"+T).addEventListener(S,e,!1)}}function D(e){var S=(e||"mGen")+(++j);return S}if(l){if(window.WeixinJSBridge&&WeixinJSBridge.invoke){t()}else{document.addEventListener("WeixinJSBridgeReady",t,!1)}}if(x){g=window.$;N=window.$}else{g=function(e){if(typeof e=="object"){return e}return document.querySelector(e)};if(!window.$){window.$=N=g}else{N=window.$}}window.onblur=function(){for(var e=0;e<i.length;e++){clearTimeout(i[e])}};function f(T){var S=document.cookie.indexOf(T+"=");if(S==-1){return""}S=S+T.length+1;var e=document.cookie.indexOf(";",S);if(e==-1){e=document.cookie.length}return document.cookie.substring(S,e)}function m(T,V,e,W,U){var X=T+"="+escape(V);if(e!=""){var S=new Date();S.setTime(S.getTime()+e*24*3600*1000);X+=";expires="+S.toGMTString()}if(W!=""){X+=";path="+W}if(U!=""){X+=";domain="+U}document.cookie=X}function J(T){var V={downAppURl:"//h5.m.jd.com/active/download/download.html?channel=jd-m",downAppIos:"https://itunes.apple.com/us/app/jing-dong-wang-gou-shou-dan/id414245413",downWeixin:"http://a.app.qq.com/o/simple.jsp?pkgname=com.jingdong.app.mall&g_f=991850",downIpad:"https://itunes.apple.com/cn/app/jing-dong-hd/id434374726?mt=8",inteneUrl:"openApp.jdMobile://360buy?type=1",inteneUrlParams:null,openAppBtnId:"",closePanelBtnId:"",closePanelId:"",closeCallblack:null,closeCallblackSource:null,cookieFlag:null,noRecord:false,sourceType:"JSHOP_SOURCE_TYPE",sourceValue:"JSHOP_SOURCE_VALUE",openAppEventId:"MDownLoadFloat_OpenNow",closePanelEventId:"MDownLoadFloat_Close",appDownCloseIntervalTime:259200000,appDownOpenIntervalTime:2592000000,isnotWriteOpenAppCookie:false};if(T){for(var U in T){if(U&&T[U]){if(U=="appDownCloseIntervalTime"||U=="appDownOpenIntervalTime"){var X=/^(-     |\+)?\d+$/;if(X.test(T[U])&&T[U]>0){try{var S=parseInt(T[U],10);V[U]=S}catch(W){}}}else{V[U]=T[U]}}}}return V}function z(T,e){var X=h(T);var U=null;if(l){var S=null;if(k){S=X}else{S=T.downWeixin}location.href=S;return}if(a){U=T.downIpad}else{if(s){U=T.downAppIos}else{U=T.downAppURl}}if(P){if(Q){var W=X;X=C(W);setTimeout(function(){window.location.href=X},50)}}if((c&&O>=9)||K||M){setTimeout(function(){var Y=document.createElement("a");Y.setAttribute("href",X),Y.style.display="none",document.body.appendChild(Y);var Z=document.createEvent("HTMLEvents");Z.initEvent("click",!1,!1),Y.dispatchEvent(Z)},0)}else{document.querySelector("#"+u).src=X}var V=Date.now();setTimeout(function(){if(e){var Y=setTimeout(function(){A(V,U)},1500);i.push(Y)}},100)}function A(T,S){var e=Date.now();if(T&&(e-T)<(1500+200)){window.location.href=S}}function h(U){var ad=[];var X=U.inteneUrlParams;var ab={category:"jump",des:"productDetail"};if(U.sourceType&&U.sourceValue){ab.sourceType=U.sourceType;ab.sourceValue=U.sourceValue;if(X&&!X.sourceType&&!X.sourceValue){X.sourceType=U.sourceType;X.sourceValue=U.sourceValue}if(U&&U.M_sourceFrom){ab.M_sourceFrom=U.M_sourceFrom}}if(X){for(var ac in X){if(ac&&X[ac]){ad.push('"'+ac+'":"'+X[ac]+'"')}}}else{for(var ac in ab){if(ac&&ab[ac]){ad.push('"'+ac+'":"'+ab[ac]+'"')}}}try{var Y=MPing.EventSeries.getSeries();if(Y){var ae=JSON.parse(Y);ae.jdv=encodeURIComponent(f("__jdv"));ae.unpl=encodeURIComponent(f("unpl"));ae.mt_xid=encodeURIComponent(f("mt_xid"));ae.mt_subsite=encodeURIComponent(f("mt_subsite"))}var aa={mt_subsite:encodeURIComponent(f("mt_subsite")),__jdv:encodeURIComponent(f("__jdv")),unpl:encodeURIComponent(f("unpl")),__jda:encodeURIComponent(f("__jda"))};Y=JSON.stringify(ae);ad.push('"m_param":'+Y);ad.push('"SE":'+JSON.stringify(aa))}catch(Z){ad.push('"m_param":null')}var T="{"+ad.join(",")+"}";var W=U.inteneUrl.split("?");var S=null;if(W.length==2){S=W[0]+"?"+W[1]+"&params="+T}else{S=W[0]+"?params="+T}var V={url:"//ccc-x.jd.com/dsp/op?openapp_url="+encodeURI(T)+"&openapp_source_type=100",method:"get",async:false,timeout:1000,error:function(){},success:function(e){}};B(V);return S}function C(e){return"intent://m.jd.com/#Intent;scheme="+e+";package=com.jingdong.app.mall;end"}function o(e){if(e.openAppBtnId){F[e.openAppBtnId]=e;L(e.openAppBtnId,e.openAppEventId);d(e.openAppBtnId,"click",function(){var V=this.getAttribute("id");var S=F[V];if(!v){var T=document.createElement("iframe");T.id=u;document.body.appendChild(T);document.getElementById(u).style.display="none";document.getElementById(u).style.width="0px";document.getElementById(u).style.height="0px";v=true}if(!S.isnotWriteOpenAppCookie){var U=S.cookieFlag?"downloadAppPlugIn_downCloseDate_"+S.cookieFlag:"downloadAppPlugIn_downCloseDate";m(U,Date.now()+"_"+S.appDownOpenIntervalTime,60,"/",".m.jd.com");m(U,Date.now()+"_"+S.appDownOpenIntervalTime,60,"/","m.jd.hk")}z(S,true)})}}function H(S){if(S.closePanelBtnId&&S.closePanelId){F[S.closePanelBtnId]=S;L(S.closePanelBtnId,S.closePanelEventId);var W=S.cookieFlag?"downloadAppPlugIn_downCloseDate_"+S.cookieFlag:"downloadAppPlugIn_downCloseDate";var U=f(W);var V=null;if(U){V=U.split("_");if(V.length==2){V[0]=parseInt(V[0],10);V[1]=parseInt(V[1],10)}else{V=null}}var e=Date.now();if(E(S)||(!S.noRecord&&V&&V.length==2&&(e-V[0])<V[1])){document.querySelector("#"+S.closePanelId).style.display="none";if(S.closeCallblack){var T=S.closeCallblackSource?S.closeCallblackSource:null;S.closeCallblack.call(T)}return}else{document.querySelector("#"+S.closePanelId).style.display="block"}d(S.closePanelBtnId,"click",function(){var aa=this.getAttribute("id");var X=F[aa];var Z=X.cookieFlag?"downloadAppPlugIn_downCloseDate_"+X.cookieFlag:"downloadAppPlugIn_downCloseDate";if(!X.noRecord){m(Z,Date.now()+"_"+X.appDownCloseIntervalTime,60,"/","m.jd.com");m(Z,Date.now()+"_"+X.appDownCloseIntervalTime,60,"/","m.jd.hk")}document.querySelector("#"+X.closePanelId).style.display="none";if(X.closeCallblack){var Y=X.closeCallblackSource?X.closeCallblackSource:null;X.closeCallblack.call(Y)}})}}function E(U){var V=I.indexOf("jdmsxh");var e=I.indexOf("jdmsxh2");var S=false;if(I.indexOf("Html5Plus")>=0||(V>=0&&V!=e)){S=true}if(S==false){var T={url:"//so.m.jd.com/downLoad/closeUa.action?_format_=json",method:"get",async:true,timeout:1000,error:function(){},success:function(Z){Z=JSON.parse(Z);if(Z&&Z.ua){var aa=Z.ua.split("|");for(var X=0;X<aa.length;X++){var W=aa[X];if(W&&I.indexOf(W)>=0){document.querySelector("#"+U.closePanelId).style.display="none";if(U.closeCallblack){var Y=U.closeCallblackSource?U.closeCallblackSource:null;U.closeCallblack.call(Y)}break}}}}};B(T)}return S}function B(T){var S;try{S=new ActiveXObject("Msxml2.XMLHTTP")}catch(V){try{S=new ActiveXObject("Microsoft.XMLHTTP")}catch(V){S=new XMLHttpRequest()}}S.ajaxRunError=true;try{S.open(T.method,T.url,T.async);if(T.timeout){var U=T.source?T.source:null;setTimeout(function(){if(S.ajaxRunError){S.onreadystatechange=function(){};S.abort();T.error.call(U)}},T.timeout)}S.onreadystatechange=function(){var W=T.source?T.source:null;if(S.readyState==4){if(S.status==200){S.ajaxRunError=false;var e=S.responseText;T.success.call(W,e)}else{T.error.call(W)}}};S.send(null)}catch(V){}}function L(W,T){try{var V=document.getElementById(W);var S=V.className;if(S){S=S+" J_ping"}else{S="J_ping"}V.className=S;V.setAttribute("report-eventid",T);if(I.indexOf("jdmsxh2")>=0){V.setAttribute("event_param",1)}else{V.setAttribute("event_param",0)}}catch(U){}}function G(e){var S=J(e);o(S);H(S)}N.downloadAppPlugIn=G;N.downloadAppPlugInOpenApp=function(e){var S=J(e);if(!v){var T=document.createElement("iframe");T.id=u;document.body.appendChild(T);document.getElementById(u).style.display="none";document.getElementById(u).style.width="0px";document.getElementById(u).style.height="0px";v=true}z(S)}})();